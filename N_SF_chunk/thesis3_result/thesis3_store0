Proof-of-Stake Protocols for Privacy-Aware Blockchains 
Chaya Ganesh1?, Claudio Orlandi1?, and Daniel Tschudi1,2? 
{ganesh,orlandi,tschudi}@cs.au.dk 
1 Department of Computer Science, DIGIT, Aarhus University 2 Concordium 
Abstract. Proof-of-stake (PoS) protocols are emerging as one of the most promising alternative to the wasteful proof-of-work (PoW) protocols for consensus in Blockchains (or distributed ledgers). However, current PoS protocols inherently disclose both the identity and the wealth of the stake-holders, and thus seem incompatible with privacy-preserving cryptocurrencies (such as ZCash, Monero, etc.). In this paper we initiate the formal study for PoS protocols with privacy properties. Our results include: 
1. 
A (theoretical) feasibility result showing that it is possible to construct a general class of private PoS (PPoS) protocols; and to add privacy to a wide class of PoS protocols, 

2. 
A privacy-preserving version of a popular PoS protocol, Ouroboros Praos. Towards our result, we defne the notion of anonymous verifable random function, which we believe is of independent interest. 


1 Introduction 
Popular decentralized cryptocurrencies like Bitcoin [Nak08] crucially rely on the existence of a distributed ledger, known as the Blockchain. The original protocols used to build and maintain the Blockchain were based on proof-of-work consensus protocols (PoW). While blockchain protocols mark a signifcant breakthrough in distributed consensus, reliance on expensive PoW components result in enormous waste of energy [OM14, CDE+16], therefore it is an important open problem to fnd alternative consensus mechanisms which are less wasteful than PoW but at the same time maintain the positive features oered by PoW. Proof-of-stake consensus protocols (PoS) are one of the most promising technology to replace PoW and still preserve similar robustness properties: while PoW provides robustness assuming that a (qualifed) majority of the computing power is honest, PoS instead relies on the assumption that a majority of the wealth in the system is controlled by honest participants. The rationale behind PoS is that users who have signifcant stakes in the system have an economic incentive in keeping the system running according to the protocol specifcation, as they risk that their stakes will become worthless if trust in the cryptocurrency vanishes. As is usual in this research space, the initial idea of proof-of-stake appeared informally in an online Bitcoin forum [bit11], and since then, there have been a series of candidates for such protocols [KN12, BLMR14, BGM16]. Recently, there have been works on formal models for proof-of-
stake and protocols with provable security guarantees [BPS16, KRDO17, GHM+17, DGKR18, BGK+18]. 
Consensus based on lottery. Very informally, a lottery-based consensus protocol works in the following way: some publicly verifable ¡°lottery¡± mechanism is implemented to elect the next committee or a block ¡°leader¡± who is then allowed to add the next block to the blockchain. The probability of a user being elected is proportional to the amount of some ¡°scarce resource¡± owned by the user. In PoW, the probability is proportional to the computing power of the user, while in PoS it is proportional to the amount of coins the user owns. Since the resource is scarce and cannot be replicated, Sybil attacks are prevented (e.g., a user cannot infate its probability of become the block leader). This, combined with the assumption that some majority of the resource is controlled by honest parties guarantees that the honest participants are in charge of the blockchain, thus guaranteeing integrity of the stored information. 
Proof-of-work. In PoW, such as Bitcoin, for every block, all users try to solve some computationally challenging puzzle. The frst user to have solved the puzzle publishes the solution together with the new 
? This work was supported by the Danish Independent Research Council under Grant-ID DFF-6108-00169 (FoCC), the European Research Council (ERC) under the European Unions¡¯s Horizon 2020 research and inno-vation program under grant agreement No 669255 (MPCPRO) and No 803096 (SPEC), and the Concordium Blockchain Research Center, Aarhus University, Denmark. 
block, and often together with a new address that allows to collect the transaction fees and the block reward, which act as economic incentives for users to participate in the consensus protocol. All other participants can verify that the received block is valid (e.g., contains a valid solution to the puzzle) and, if so, append it to their local view of the Blockchain. Note that, if we assume that users are connected to each other using anonymous communication channels (e.g., Tor), then PoW provides full anonymity i.e., given two blocks it is hard to tell whether they came from the same user or not. 
Proof-of-stake. On the other hand, PoS systems follow a dierent approach: here we must assume that the Blockchain contains information about the wealth owned by the users in the system. Then, for every block, each user has a way to locally compute (using a pseudorandom process) whether they won 